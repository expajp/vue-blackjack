# Vue.jsでブラックジャック

## 概要
以下2記事を参考に、Vue.jsでブラックジャックを作る

* [プログラミング入門者からの卒業試験は『ブラックジャック』を開発すべし \- Qiita](https://qiita.com/hirossyi73/items/cf8648c31898216312e5)
* [Vue\.jsでブラックジャックを作ってみた \- Qiita](https://qiita.com/t2kojima/items/88a924fa3807909e0488)

1ページ完結なので、VuexやVue Routerは使わない

## 仕様
上記記事から引用

* 初期カードは 52 枚。引く際にカードの重複は無いようにする
* プレイヤーとディーラーの 2 人対戦。プレイヤーは実行者、ディーラーは自動的に実行
* 実行開始時、プレイヤーとディーラーはそれぞれ、カードを 2 枚引く。引いたカードは画面に表示する。
    * ただし、ディーラーの 2 枚目のカードは分からないようにする
* その後、先にプレイヤーがカードを引く。プレイヤーが 21 を超えていたらバースト、その時点でゲーム終了
* プレイヤーは、カードを引くたびに、次のカードを引くか選択できる
* プレイヤーが引き終えたら、その後ディーラーは、自分の手札が 17 以上になるまで引き続ける
* プレイヤーとディーラーが引き終えたら勝負。より 21 に近い方の勝ち
* J と Q と K は 10 として扱う
* ダブルダウンなし、スピリットなし、サレンダーなし、その他特殊そうなルールなし

## 設計
* 必要なコンポーネント
    * カード
    * 手札
    * プレイヤー
    * ディーラー
    * ゲーム
* ゲームの子がプレイヤーとディーラー、プレイヤーとディーラーの子が手札、手札の子がカードという設計
    * プレイヤーとディーラー、どうにかしてコードの共通化ができるかも知れない
    * 先にコピペで実装しておいて、あとで共通化したほうが見通しが良さそう
* 必要なロジック
    * 得点計算
    * 勝敗判定
    * デッキ
* あとはvue-cliで生成したファイル構成に従って徐々に実装していく

## 開発というか、写経


## コードリーディング
### コンポーネントごとに持たせている機能
* Card
    * 状態を保持して表示するだけのコンポーネント
    * Player, Dealerが親になる
    * 親から提供された情報を元に表示を決定する
* Dealer
    * 手札を表示する
    * 手札を初期化し、イベントリスナをセットする
    * Gameから降ってきたpostexecイベントに反応する
        * 17以上になるまでカードを引き続ける
        * resultを発火させ、スコアを計算する
* Player
    * Dealerよりも機能が多い
        * もっと人数が多ければ（麻雀とか）、共通コンポーネントができるかもね
    * 手札とボタンを表示する
        * ボタンにはイベントリスナを設定する
    * 手札を初期化し、点数を計算する
        * ボタンでしか操作しないので、イベントリスナはセットしない
    * hitする
        * 手札を引く動作
        * 手札を1枚増やして再計算
    * standする
        * 勝負する動作
        * ここではstandイベントを発生させて親のGameコンポーネントに通知するだけ
    * resultを監視する
        * ウォッチャを使う
        * 手札を引いた瞬間Burstする可能性がある
        * Burstしたのを検知すると、standイベントを発生させてGameコンポーネントに通知する
* Game
    * ゲームとしてのデータを持つ
        * プレイヤーとディーラーの得点
        * ボタンを表示するかどうか
    * standする
        * 勝負する
        * プレイヤーの得点を受け取って起動
        * Gameコンポーネントの「プレイヤーの得点」を上書き
        * ディーラーのpostexecメソッドを「Burstしたかどうか」を引数に起動
    * postexecする
        * 勝負後の処理を行う
        * ディーラーのpostexecメソッドからのみ起動される
        * ディーラーの得点を受け取って起動
        * Gameコンポーネントの「ディーラーの得点」を上書き
        * ボタンを非表示にする
        * 得点を表示する
    * resultMessageを生成する
        * ボタンが表示されている場合はなにもなし
        * ボタンが表示されていない場合＝勝敗が決している場合は勝敗を表示

## テストケースの設計
### 役の正常系
* ロイヤルストレートフラッシュ
  * ~スートで勝敗~
* ただのストレートフラッシュ
  * ~数字で勝敗~
  * ~数字一緒でスートで勝敗~
* フォーカード
  * ~数字で勝敗~
* フルハウス
  * ~数字で勝敗~
* フラッシュ
  * ~数字で勝敗~
  * ~数字一緒でスートで勝敗~
* ストレート
  * 数字で勝敗
  * 数字一緒でスートで勝敗
* スリーカード
  * 数字で勝敗
* ツーペア
  * 数字で勝敗
  * 数字一緒でスートで勝敗
* ワンペア
  * 数字で勝敗
  * 数字一緒でスートで勝敗

### 今まで観測された
* ワンペアなのに、最小と最大の差が4枚でストレート判定される
